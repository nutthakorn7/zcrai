#!/usr/bin/expect -f
set timeout 120

# Upload Observable Service
spawn scp -o StrictHostKeyChecking=no /Users/pop7/Code/zcrAI/backend/api/core/services/observable.service.ts root@45.118.132.160:/root/zcrAI/backend/api/core/services/
expect "password:"
send "gg\r"
expect eof

# Upload Observable Controller
spawn scp -o StrictHostKeyChecking=no /Users/pop7/Code/zcrAI/backend/api/controllers/observable.controller.ts root@45.118.132.160:/root/zcrAI/backend/api/controllers/
expect "password:"
send "gg\r"
expect eof

# Upload updated Case Service
spawn scp -o StrictHostKeyChecking=no /Users/pop7/Code/zcrAI/backend/api/core/services/case.service.ts root@45.118.132.160:/root/zcrAI/backend/api/core/services/
expect "password:"
send "gg\r"
expect eof

# Upload updated Alert Service
spawn scp -o StrictHostKeyChecking=no /Users/pop7/Code/zcrAI/backend/api/core/services/alert.service.ts root@45.118.132.160:/root/zcrAI/backend/api/core/services/
expect "password:"
send "gg\r"
expect eof

# Upload main index.ts
spawn scp -o StrictHostKeyChecking=no /Users/pop7/Code/zcrAI/backend/api/index.ts root@45.118.132.160:/root/zcrAI/backend/api/
expect "password:"
send "gg\r"
expect eof

# Restart PM2
spawn ssh -o StrictHostKeyChecking=no root@45.118.132.160 "pm2 restart zcrai-api"
expect "password:"
send "gg\r"
expect eof
